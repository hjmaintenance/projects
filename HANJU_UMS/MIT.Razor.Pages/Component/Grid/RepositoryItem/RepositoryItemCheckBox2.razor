@using DevExpress.Blazor
@using MIT.DataUtil.Common;
@using System.Data;

@inherits RepositoryItemComponentBase

<DxCheckBox T="bool" Enabled="@Enable" ReadOnly="@ReadOnly"
            Checked="@(IsCheckValue())"
            ValueChecked="@ValueChecked"
            ValueUnchecked="@ValueUnchecked"
            CheckedChanged="@((bool value) => OnCheckedChanged(CellContext, value))"
            CheckType="CheckType" />


@code {

    /// <summary> 체크시 VALUE 값 </summary>
    [Parameter]    public bool ValueChecked { get; set; } = true;
    /// <summary> 체크해제시 VALUE 값 </summary>
  [Parameter] public bool ValueUnchecked { get; set; } = false;

    /// <summary>
    /// 체크 모드 설정
    /// </summary>
    [Parameter]
    public CheckType CheckType { get; set; } = CheckType.Checkbox;

    private void OnCheckedChanged(GridDataColumnCellDisplayTemplateContext? context, bool value)
    {
        
        if (context == null || context.DataItem == null)
            return;
        var grd = context.Grid as DxGrid;
        var dataItem = context.DataItem as DataRowView;

        if (dataItem == null || grd == null)
            return;

        dataItem["CHK"] = "Y";
        dataItem[context.DataColumn.FieldName] = value;

        grd.SelectDataItem(dataItem);
    }
}
